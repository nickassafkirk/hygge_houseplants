{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container-fluid products-container">
    <div class="row">
        {% for product in products %}
        <div class="col-12 col-sm-6 col-md-4 col-lg-3 product-tile my-3">
            <div>
                <a href="{% url 'single_product' product.id %}">
                    <div class="product-tile-img text-center">
                        <img src="{% if product.image %}{{ product.image.url }}{% else %}{{ MEDIA_URL }}hero1.jpg{% endif %}" alt="{{ product.name }}">
                    </div>
                </a>
                <div class="product-tile-name mt-3">
                    <h5 class="ms-2">{{ product.name }}</h5>
                </div>
                <h4 class="text-center">â‚¬{{ product.price }}</h4>
                <div class="product-tile-buttons my-4">
                    <a href="{% url 'single_product' product.id %}" class="btn btn-dark"><i class="far fa-eye"></i><br>View Product</a>
                    <a href="" class="btn btn-bright"><i class="fas fa-cart-plus"></i><br>Add to Cart</a>
                </div>
                {% if request.user.is_superuser %}
                    <div class="text-center mb-2 edit-delete-container">
                        <a href="" class="text-info">Edit Product</a> | <a class="text-danger delete-product">Delete Product</a>
                        <div class="are-you-sure">
                            <a href="{% url 'delete_product' product.id %}" class="btn btn-success"><i class="fas fa-trash-alt"></i>  Delete</a> | <span class="cancel btn btn-danger"><i class="fas fa-times-circle"></i>  Cancel</span>
                        </div>
                    </div>
                {% endif %}
                <a href="{% url 'products' %}?category={{ product.category }}" class="product-path">
                    <small class="ms-2 ">
                        <i class="fas fa-folder"></i> {{ product.category | title }}
                    </small>
                </a>
                <hr>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

{% endblock %}

{% block footerjs %} 
<script type="text/javascript">
    
    let deleteButtons = document.querySelectorAll('.delete-product')
    deleteButtons.forEach(button => button.addEventListener('click', confirmDelete));

    function confirmDelete(event) {
        popup = $(this).next()
        popup.show();

        cancelButton = popup.children('span')
        cancelButton.click( function() {
            popup.hide()
        })

    }

</script>
{% endblock %}
